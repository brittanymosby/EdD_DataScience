setwd("~/GitHub/edd_datascience/scripts")
load(pd)
load(pd.Rdata)
load("pd.Rdata")
els <- readRDS("C:/Users/blmos/OneDrive/Documents/GitHub/edd_datascience/scripts/els.Rds")
training <- read.csv("C:/Users/blmos/Dropbox/School Things/VU Peabody/EDD LLO Teaching/LLO 8200 - Intro to Data Science/FALL 2020/training.csv")
View(training)
mydata<-training
table(mydata$IsBadBuy)
prop.table(table(mydata$IsBadBuy))
mydata%>%count(IsBadBuy)%>%mutate(p=prop.table(n))%>%kable(format="markdown")
library(tidyverse)
library(knitr)
library(modelr)
library(caret)
library(forcats)
#mydata <- read.csv("training.csv", header=TRUE)
#head(mydata)
mydata<-training
table(mydata$IsBadBuy)
prop.table(table(mydata$IsBadBuy))
mydata%>%count(IsBadBuy)%>%mutate(p=prop.table(n))%>%kable(format="markdown")
nrow(mydata)
mydata$Transmission <- as.character(mydata$Transmission)
mydata1 <- mydata[(mydata$Transmission == "AUTO" | mydata$Transmission == "MANUAL"),]
nrow(mydata1)
prop.table(table(mydata$IsOnlineSale,mydata$IsBadBuy),margin=1)
prop.table(table(mydata$VNST,mydata$IsBadBuy),margin=1)
prop.table(table(mydata$Color,mydata$IsBadBuy),margin=1)
prop.table(table(mydata$Transmission,mydata$IsBadBuy),margin=1)
prop.table(table(mydata$WheelType,mydata$IsBadBuy),margin=1)
prop.table(table(mydata$Nationality,mydata$IsBadBuy),margin=1)
prop.table(table(mydata$Size,mydata$IsBadBuy),margin=1)
prop.table(table(mydata$TopThreeAmericanName,mydata$IsBadBuy),margin=1)
library(plyr)
mu <- ddply(mydata, "IsBadBuy", summarise, grp.mean=mean(VehOdo))
head(mu)
t.test(mydata$VehOdo~mydata$IsBadBuy)
data_sum<-mydata%>%
group_by(Size, VehicleAge, Transmission)%>%
summarize(mean_bad=mean(IsBadBuy))%>%
arrange(-mean_bad)
data_sum%>%kable()
gg<-ggplot(data_sum,aes(x=Transmission,y=mean_bad, fill=VehicleAge))
gg<-gg+geom_bar(stat="identity")
gg<-gg+facet_wrap(~Size)
gg
# Linear model
lm_mod<-lm(IsBadBuy~
VehicleAge+Transmission+Nationality+TopThreeAmericanName+WarrantyCost,
data=mydata,y=TRUE,na.exclude=TRUE);summary(lm_mod)
#Predictions
mydata<-mydata%>%add_predictions(lm_mod)%>%mutate(pred_lm_out=ifelse(pred>=.5,1,0))
pred_table<-table(mydata$IsBadBuy,mydata$pred_lm_out)
prop.table(pred_table)
#rownames(pred_table)<-c("Predicted 0","Predicted 1")
#colnames(pred_table)<-c("Actually 0","Actually 1")
pred_table
#Logisitic model
logit_mod<-glm(IsBadBuy~
VehicleAge+
Make+
WarrantyCost+
TopThreeAmericanName,
data=mydata,
na.action=na.exclude,
family=binomial(link="logit"),
y=TRUE)
summary(logit_mod)
mydata<-mydata%>%add_predictions(logit_mod) #%>%mutate(pred_logit=predict(logit_mod,type="response"))
#mydata<-mydata%>%
#   mutate(pred_logit_out=ifelse(pred_logit>=.5,1,0))
confusionMatrix(data=as_factor(mydata$pred_logit_out),reference=as_factor(mydata$IsBadBuy))
format <- c(17,54,64)
chisq.test(format, p=c(1/3, 1/3, 1/3))
#Note: unless you're given data for the expected frequencies, use an equal distribution of data
anotherexample <-c(36, 38, 27, 33) #note - there are four groups here
chisq.test(anotherexample, p=c(1/4, 1/4, 1/4, 1/4))
graduate <- read.table("graduate.txt", header=TRUE, sep="\t")
#label the levels of the variables for the table we're building (this is optional - but helfpul to read your table)
graduate$Business <- factor(graduate$Business, levels= c("0","1"), labels = c("NonBiz", "Biz"))
graduate$Doctorate <- factor(graduate$Doctorate, levels= c("0","1"), labels = c("Masters", "Doctorate"))
#Now, let's summarize the data in a table (call it gradtable)
gradtable <- table(graduate$Business, graduate$Doctorate) #look at the table after you create it
gradtable
chisq.test(gradtable, correct=F)
#Note: we use correct = F to get the same test statistic we computed by hand (no continuity correction)
#for some future analyses you may want the continuity correction/you should do research to determine when this may be the case
gradtable2 <- data.frame(c(574,176), c(185,3))
chisq.test(gradtable2, correct=F)
#calculating odds ratio for odds of conferring masters for biz vs. non-bus majors
(185/3)/(574/176)
#odds of pursuing a masters degree in business compared to pursuing a masters degree in non-business.
#odds = 18.91
format <- c(17,54,64)
chisq.test(format, p=c(1/3, 1/3, 1/3))
#Note: unless you're given data for the expected frequencies, use an equal distribution of data
anotherexample <-c(36, 38, 27, 33) #note - there are four groups here
chisq.test(anotherexample, p=c(1/4, 1/4, 1/4, 1/4))
View(graduate)
graduate <- read.table("graduate.txt", header=TRUE, sep="\t")
View(graduate)
graduate <- read.table("graduate.txt", header=TRUE, sep="\t")
#label the levels of the variables for the table we're building (this is optional - but helfpul to read your table)
graduate$Business <- factor(graduate$Business, levels= c("0","1"), labels = c("NonBiz", "Biz"))
graduate$Doctorate <- factor(graduate$Doctorate, levels= c("0","1"), labels = c("Masters", "Doctorate"))
#Now, let's summarize the data in a table (call it gradtable)
gradtable <- table(graduate$Business, graduate$Doctorate) #look at the table after you create it
gradtable
chisq.test(gradtable, correct=F)
#Note: we use correct = F to get the same test statistic we computed by hand (no continuity correction)
#for some future analyses you may want the continuity correction/you should do research to determine when this may be the case
View(graduate)
gradtable2 <- data.frame(c(574,176), c(185,3))
chisq.test(gradtable2, correct=F)
#calculating odds ratio for odds of conferring masters for biz vs. non-bus majors
(185/3)/(574/176)
#odds of pursuing a masters degree in business compared to pursuing a masters degree in non-business.
#odds = 18.91
